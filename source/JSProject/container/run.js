"use strict";var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports, "__esModule", { value: true });exports.dockerCli = dockerCli;exports.dockerComposeCli = dockerComposeCli;exports.dockerStackCli = dockerStackCli;var _child_process = require("child_process");
var _os = _interopRequireDefault(require("os"));
var _path = _interopRequireDefault(require("path"));
var _fs = _interopRequireDefault(require("fs"));



var jsYaml = _interopRequireWildcard(require("js-yaml"));
var _mkdirp = _interopRequireDefault(require("mkdirp"));
var _jsonfile = _interopRequireDefault(require("jsonfile"));
var _paramCase = require("param-case");

const developmentCodeFolder = _path.default.join(_os.default.homedir(), 'code'),
yarnLinkFolrder = _path.default.join(_os.default.homedir(), '.config');


const dockerDeploymentImage = 'myuserindocker/deployment-environment:latest' || 'node:current';

async function dockerCli({ api, scriptCommand = '/bin/bash' } = {}) {
  const applicationPath = _path.default.join(api.project.configuration.rootPath, 'entrypoint/cli'),
  rootPath = api.project.configuration.rootPath,
  containerProjectPath = rootPath;

  let executableCommand = [
  'docker',
  `run`,




  '--init',
  '--sig-proxy',
  `--interactive --tty`,
  `--rm`,
  `--workdir ${containerProjectPath}`,

  `--volume ${rootPath}:${containerProjectPath}`,

  `--volume ${developmentCodeFolder}:${developmentCodeFolder}`,
  `--volume ${yarnLinkFolrder}:${yarnLinkFolrder}`,
  `--volume /var/run/docker.sock:/var/run/docker.sock`,



  `--user ${_os.default.userInfo().uid}:${_os.default.userInfo().gid}`,
  `--volume /etc/passwd:/etc/passwd:ro`,
  `--volume /etc/group:/etc/group:ro`,
  `--volume /etc/shadow:/etc/shadow:ro`,


  `--network=${'external'}`,
  `--network-alias ${'application'}`,



  `-p 443:443 -p 8080:8080 -p 8081:8081 -p 8082:8082 -p 8083:8083 -p 8084:8084 -p 8085:8085`,
  `-p 9229:9229`,
  `-p 9090:9090 -p 9901:9901 -p 9902:9902`,




  `${dockerDeploymentImage}`,
  scriptCommand];


  console.log('container command' + ': \n', scriptCommand);
  console.log(`• docker command: "${executableCommand.join(' ')}"`);

  let option = {
    cwd: rootPath,
    detached: false,
    shell: true,
    stdio: [0, 1, 2],

    env: Object.assign({}, process.env, {}) };



  const [command, ...commandArgument] = executableCommand;
  (0, _child_process.spawnSync)(command, commandArgument, option);
}



async function dockerComposeCli({ api, scriptCommand = '/bin/bash' } = {}) {
  const targetProjectConf = api.project.configuration.configuration,
  rootPath = api.project.configuration.rootPath,
  targetTemporaryFolder = _path.default.join(rootPath, 'temporary'),
  containerProjectPath = rootPath;

  await (0, _mkdirp.default)(targetTemporaryFolder);

  let option = {
    cwd: rootPath,
    detached: false,
    shell: true,
    stdio: [0, 1, 2],

    env: Object.assign({}, process.env, {}) };




  let portList = [
  ...targetProjectConf.apiGateway.service.map(item => item.port).filter(item => item),

  ...[

  9229,

  9090,
  9901,
  9902]];


  let serviceConfig = {
    version: '3.7',

    networks: {
      internal: {
        driver: 'bridge' } },



    services: {
      application: {
        image: dockerDeploymentImage,



        ports: portList.map(port => {
          return {
            target: port,
            published: port };


        }),

        networks: {
          internal: {
            aliases: ['application'] } },



        volumes: [
        `${rootPath}:${containerProjectPath}`,

        `${developmentCodeFolder}:${developmentCodeFolder}`,
        `${yarnLinkFolrder}:${yarnLinkFolrder}`,
        `/var/run/docker.sock:/var/run/docker.sock`,


        `/etc/passwd:/etc/passwd:ro`,
        `/etc/group:/etc/group:ro`,
        `/etc/shadow:/etc/shadow:ro`],


        user: `${_os.default.userInfo().uid}:${_os.default.userInfo().gid}`,
        working_dir: rootPath,


        command: scriptCommand,






        tty: true,
        stdin_open: true },


      memgraph: {
        image: 'memgraph:latest',


        ports: [
        {
          target: 7687 }],




        networks: {
          internal: {
            aliases: ['memgraph'] } } } } };







  let yamlFile = _path.default.join(targetTemporaryFolder, 'dockerCompose.yaml');
  _fs.default.writeFileSync(yamlFile, jsYaml.dump(serviceConfig, { lineWidth: Infinity, noCompatMode: true }));

  let dockerComposeCommand = `docker-compose --file ${yamlFile} --project-name webappProject --log-level INFO`;

  {


    let executableCommand = [
    [
    dockerComposeCommand,
    'down --volumes'].
    join(' ')];

    const [command, ...commandArgument] = executableCommand;
    (0, _child_process.spawnSync)(command, commandArgument, option);
  }

  let executableCommand = [
  [
  dockerComposeCommand,







  `up --no-build --force-recreate --abort-on-container-exit --always-recreate-deps`].
  join(' ')];


  console.log('container command' + ': \n', scriptCommand);
  console.log(`• docker command: "${executableCommand.join(' ')}"`);
  const [command, ...commandArgument] = executableCommand;
  (0, _child_process.spawnSync)(command, commandArgument, option);



  process.on('SIGINT', (code, signal) => {
    console.log(`[Process ${process.pid}]: signal ${signal}, code ${code};`);

    let executableCommand = [
    [
    dockerComposeCommand,
    'down'].

    join(' ')];

    const [command, ...commandArgument] = executableCommand;
    (0, _child_process.spawnSync)(command, commandArgument, option);
  });
}

async function dockerStackCli({ api } = {}) {var _projectName;
  const targetProjectConf = api.project.configuration.configuration,
  rootPath = api.project.configuration.rootPath,
  targetTemporaryFolder = _path.default.join(rootPath, 'temporary'),
  containerProjectPath = rootPath,
  targetPackagePath = _path.default.join(rootPath, 'package.json');
  const packageConfig = _jsonfile.default.readFileSync(targetPackagePath);
  let projectName = packageConfig.name.substring(packageConfig.name.lastIndexOf('/') + 1);
  let imageName = (_projectName = projectName, (0, _paramCase.paramCase)(_projectName));

  await (0, _mkdirp.default)(targetTemporaryFolder);

  let option = {
    cwd: rootPath,
    detached: false,
    shell: true,
    stdio: [0, 1, 2],

    env: Object.assign({}, process.env, {}) };




  let portList = [
  ...targetProjectConf.apiGateway.service.map(item => item.port).filter(item => item),

  ...[

  9229,

  9090,
  9901,
  9902]];


  let serviceConfig = {
    version: '3.7',

    networks: {
      overlay: {
        driver: 'overlay' } },



    services: {
      application: {
        image: `myuserindocker/${imageName}:latest`,



        ports: portList.map(port => {
          return {
            target: port,
            published: port };


        }),

        networks: {
          overlay: {
            aliases: ['application'] } },



        volumes: [],



        deploy: {
          replicas: 1,




          update_config: {
            parallelism: 1,
            delay: '10s' },

          restart_policy: {
            condition: 'on-failure' || 'any',
            delay: '2s' } },










        tty: true,
        stdin_open: true },


      memgraph: {
        image: 'memgraph:latest',


        ports: [
        {
          target: 7687 }],




        networks: {
          overlay: {
            aliases: ['memgraph'] } } } } };







  let yamlFile = _path.default.join(targetTemporaryFolder, 'dockerStack.yaml');
  _fs.default.writeFileSync(yamlFile, jsYaml.dump(serviceConfig, { lineWidth: Infinity, noCompatMode: true }));

  let dockerStackCommand = `docker --log-level INFO`;








  let executableCommand = [[dockerStackCommand, `stack --orchestrator swarm deploy --compose-file ${yamlFile} --resolve-image changed application`].join(' ')];

  console.log(`• docker command: "${executableCommand.join(' ')}"`);
  const [command, ...commandArgument] = executableCommand;
  (0, _child_process.spawnSync)(command, commandArgument, option);







}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NvdXJjZS9KU1Byb2plY3QvY29udGFpbmVyL3J1bi5qcyJdLCJuYW1lcyI6WyJkZXZlbG9wbWVudENvZGVGb2xkZXIiLCJwYXRoIiwiam9pbiIsIm9wZXJhdGluZ1N5c3RlbSIsImhvbWVkaXIiLCJ5YXJuTGlua0ZvbHJkZXIiLCJkb2NrZXJEZXBsb3ltZW50SW1hZ2UiLCJkb2NrZXJDbGkiLCJhcGkiLCJzY3JpcHRDb21tYW5kIiwiYXBwbGljYXRpb25QYXRoIiwicHJvamVjdCIsImNvbmZpZ3VyYXRpb24iLCJyb290UGF0aCIsImNvbnRhaW5lclByb2plY3RQYXRoIiwiZXhlY3V0YWJsZUNvbW1hbmQiLCJ1c2VySW5mbyIsInVpZCIsImdpZCIsImNvbnNvbGUiLCJsb2ciLCJvcHRpb24iLCJjd2QiLCJkZXRhY2hlZCIsInNoZWxsIiwic3RkaW8iLCJlbnYiLCJPYmplY3QiLCJhc3NpZ24iLCJwcm9jZXNzIiwiY29tbWFuZCIsImNvbW1hbmRBcmd1bWVudCIsImRvY2tlckNvbXBvc2VDbGkiLCJ0YXJnZXRQcm9qZWN0Q29uZiIsInRhcmdldFRlbXBvcmFyeUZvbGRlciIsInBvcnRMaXN0IiwiYXBpR2F0ZXdheSIsInNlcnZpY2UiLCJtYXAiLCJpdGVtIiwicG9ydCIsImZpbHRlciIsInNlcnZpY2VDb25maWciLCJ2ZXJzaW9uIiwibmV0d29ya3MiLCJpbnRlcm5hbCIsImRyaXZlciIsInNlcnZpY2VzIiwiYXBwbGljYXRpb24iLCJpbWFnZSIsInBvcnRzIiwidGFyZ2V0IiwicHVibGlzaGVkIiwiYWxpYXNlcyIsInZvbHVtZXMiLCJ1c2VyIiwid29ya2luZ19kaXIiLCJ0dHkiLCJzdGRpbl9vcGVuIiwibWVtZ3JhcGgiLCJ5YW1sRmlsZSIsImZpbGVzeXN0ZW0iLCJ3cml0ZUZpbGVTeW5jIiwianNZYW1sIiwiZHVtcCIsImxpbmVXaWR0aCIsIkluZmluaXR5Iiwibm9Db21wYXRNb2RlIiwiZG9ja2VyQ29tcG9zZUNvbW1hbmQiLCJvbiIsImNvZGUiLCJzaWduYWwiLCJwaWQiLCJkb2NrZXJTdGFja0NsaSIsInRhcmdldFBhY2thZ2VQYXRoIiwicGFja2FnZUNvbmZpZyIsIm1vZGlmeUpzb24iLCJyZWFkRmlsZVN5bmMiLCJwcm9qZWN0TmFtZSIsIm5hbWUiLCJzdWJzdHJpbmciLCJsYXN0SW5kZXhPZiIsImltYWdlTmFtZSIsImNvbnZlcnRUb1BhcmFtQ2FzZSIsIm92ZXJsYXkiLCJkZXBsb3kiLCJyZXBsaWNhcyIsInVwZGF0ZV9jb25maWciLCJwYXJhbGxlbGlzbSIsImRlbGF5IiwicmVzdGFydF9wb2xpY3kiLCJjb25kaXRpb24iLCJkb2NrZXJTdGFja0NvbW1hbmQiXSwibWFwcGluZ3MiOiJ5V0FBQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLE1BQU1BLHFCQUFxQixHQUFHQyxjQUFLQyxJQUFMLENBQVVDLFlBQWdCQyxPQUFoQixFQUFWLEVBQXFDLE1BQXJDLENBQTlCO0FBQ0VDLGVBQWUsR0FBR0osY0FBS0MsSUFBTCxDQUFVQyxZQUFnQkMsT0FBaEIsRUFBVixFQUFxQyxTQUFyQyxDQURwQjs7O0FBSUEsTUFBTUUscUJBQXFCLEdBQUcsa0RBQWtELGNBQWhGOztBQUVPLGVBQWVDLFNBQWYsQ0FBeUIsRUFBRUMsR0FBRixFQUF1Q0MsYUFBYSxHQUFHLFdBQXZELEtBQXVFLEVBQWhHLEVBQW9HO0FBQ3pHLFFBQU1DLGVBQWUsR0FBR1QsY0FBS0MsSUFBTCxDQUFVTSxHQUFHLENBQUNHLE9BQUosQ0FBWUMsYUFBWixDQUEwQkMsUUFBcEMsRUFBOEMsZ0JBQTlDLENBQXhCO0FBQ0VBLEVBQUFBLFFBQVEsR0FBR0wsR0FBRyxDQUFDRyxPQUFKLENBQVlDLGFBQVosQ0FBMEJDLFFBRHZDO0FBRUVDLEVBQUFBLG9CQUFvQixHQUFHRCxRQUZ6Qjs7QUFJQSxNQUFJRSxpQkFBaUIsR0FBRztBQUN0QixVQURzQjtBQUVyQixPQUZxQjs7Ozs7QUFPdEIsVUFQc0I7QUFRdEIsZUFSc0I7QUFTckIsdUJB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QUFQLENBQVl0QixhQUFaLEVBQTJCLEVBQUV1QixTQUFTLEVBQUVDLFFBQWIsRUFBdUJDLFlBQVksRUFBRSxJQUFyQyxFQUEzQixDQUFuQzs7QUFFQSxNQUFJeUIsa0JBQWtCLEdBQUkseUJBQTFCOzs7Ozs7Ozs7QUFTQSxNQUFJN0UsaUJBQWlCLEdBQUcsQ0FBQyxDQUFDNkUsa0JBQUQsRUFBc0Isb0RBQW1EaEMsUUFBUyxzQ0FBbEYsRUFBeUgxRCxJQUF6SCxDQUE4SCxHQUE5SCxDQUFELENBQXhCOztBQUVBaUIsRUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQWEsc0JBQXFCTCxpQkFBaUIsQ0FBQ2IsSUFBbEIsQ0FBdUIsR0FBdkIsQ0FBNEIsR0FBOUQ7QUFDQSxRQUFNLENBQUM0QixPQUFELEVBQVUsR0FBR0MsZUFBYixJQUFnQ2hCLGlCQUF0QztBQUNBLGdDQUFVZSxPQUFWLEVBQW1CQyxlQUFuQixFQUFvQ1YsTUFBcEM7Ozs7Ozs7O0FBUUQiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBleGVjU3luYywgc3Bhd24sIHNwYXduU3luYyB9IGZyb20gJ2NoaWxkX3Byb2Nlc3MnXG5pbXBvcnQgb3BlcmF0aW5nU3lzdGVtIGZyb20gJ29zJ1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCdcbmltcG9ydCBmaWxlc3lzdGVtIGZyb20gJ2ZzJ1xuaW1wb3J0IGFzc2VydCBmcm9tICdhc3NlcnQnXG5pbXBvcnQgcmVzb2x2ZSBmcm9tICdyZXNvbHZlJyAvLyB1c2UgJ3Jlc29sdmUnIG1vZHVsZSB0byBhbGxvdyBwYXNzaW5nICdwcmVzZXJ2ZSBzeW1saW5rcycgb3B0aW9uIHRoYXQgaXMgbm90IHN1cHBvcnRlZCBieSByZXF1aXJlLnJlc29sdmUgbW9kdWxlLlxuaW1wb3J0ICogYXMgZG9ja2Vyb2RlIGZyb20gJ2RvY2tlcm9kZSdcbmltcG9ydCAqIGFzIGpzWWFtbCBmcm9tICdqcy15YW1sJ1xuaW1wb3J0IGNyZWF0ZURpcmVjdG9yeVJlY3Vyc2l2ZSBmcm9tICdta2RpcnAnXG5pbXBvcnQgbW9kaWZ5SnNvbiBmcm9tICdqc29uZmlsZSdcbmltcG9ydCB7IHBhcmFtQ2FzZSBhcyBjb252ZXJ0VG9QYXJhbUNhc2UgfSBmcm9tICdwYXJhbS1jYXNlJ1xuLy8gd2hpbGUgZGV2ZWxvcGluZywgYWxsb3cgZGVwZW5kZW5jeSBzeW1saW5rcyB0byB3b3JrIGluIGNvbnRhaW5lcnMuXG5jb25zdCBkZXZlbG9wbWVudENvZGVGb2xkZXIgPSBwYXRoLmpvaW4ob3BlcmF0aW5nU3lzdGVtLmhvbWVkaXIoKSwgJ2NvZGUnKSxcbiAgeWFybkxpbmtGb2xyZGVyID0gcGF0aC5qb2luKG9wZXJhdGluZ1N5c3RlbS5ob21lZGlyKCksICcuY29uZmlnJylcblxuLy8gdGhlIGltYWdlIHVzZWQgZm9yIGRldmVsb3BtZW50LCBidWlsZGluZyBvZiBwcm9qZWN0cywgYW5kIHByb2R1Y3Rpb24gZGVwbG95bWVudCwgd2hpY2ggY29udGFpbnMgZXNzZW50aWFsIHRvb2xzIGFuZCBiaW5hcmllcyAoZS5nLiByc3luYylcbmNvbnN0IGRvY2tlckRlcGxveW1lbnRJbWFnZSA9ICdteXVzZXJpbmRvY2tlci9kZXBsb3ltZW50LWVudmlyb25tZW50OmxhdGVzdCcgfHwgJ25vZGU6Y3VycmVudCcgLy8gbm9kZWpzIDEyIHRvIHN1cHBvcnQgbm9kZWdpdCB2ZXJzaW9uIHRoYXQgd29ya3Mgd2l0aCBEZWJpYW4gMTBcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRvY2tlckNsaSh7IGFwaSAvKiBzdXBwbGllZCBieSBzY3JpcHRNYW5hZ2VyICovLCBzY3JpcHRDb21tYW5kID0gJy9iaW4vYmFzaCcgfSA9IHt9KSB7XG4gIGNvbnN0IGFwcGxpY2F0aW9uUGF0aCA9IHBhdGguam9pbihhcGkucHJvamVjdC5jb25maWd1cmF0aW9uLnJvb3RQYXRoLCAnZW50cnlwb2ludC9jbGknKSxcbiAgICByb290UGF0aCA9IGFwaS5wcm9qZWN0LmNvbmZpZ3VyYXRpb24ucm9vdFBhdGgsXG4gICAgY29udGFpbmVyUHJvamVjdFBhdGggPSByb290UGF0aFxuXG4gIGxldCBleGVjdXRhYmxlQ29tbWFuZCA9IFtcbiAgICAnZG9ja2VyJyxcbiAgICBgcnVuYCxcblxuICAgIC8vIGAtLW5hbWUgJHsncHJvamVjdCd9YCxcblxuICAgIC8vIC0tZXhwZXJpbWVudGFsLW1vZHVsZXMgLS1pbnB1dC10eXBlPWNvbW1vbmpcbiAgICAnLS1pbml0JywgLy8gRml4ZXMgc2lnbmFsIGhhbmRsZXJzICYgcmVhcGluZyAocHJvY2VzcyBvZiBlbGltaW5hdGluZyB6b21iaWUgcHJvY2Vzc2VzKS4gIGh0dHBzOi8vZ2l0aHViLmNvbS9rcmFsbGluL3RpbmkgaHR0cHM6Ly9naXRodWIuY29tL2RvY2tlci9jbGkvcHVsbC8xODQxXG4gICAgJy0tc2lnLXByb3h5JywgLy8gcGFzcyBzaWduYWxzXG4gICAgYC0taW50ZXJhY3RpdmUgLS10dHlgLCAvLyBhbGxvY2F0ZSBhIHRlcm1pbmFsIC0gdGhpcyBhbGxvd3MgZm9yIGludGVyYWN0aW5nIHdpdGggdGhlIGNvbnRhaW5lciBwcm9jZXNzLiB0dHkgPSBVbml4L0xpbnV4IHRlcm1pbmFsIGFjY2VzcyBoYW5kbGluZyB1c2luZyBtb2RlbSBiYXNlZCBjb25uZWN0aW9uIChhbGxvd3MgaW5wdXQgZnJvbSB0ZXJtaW5hbCksIGl0ZXJhY3RpdmUgPSBhY2NlcHRzIGlucHV0IGZyb20gaG9zdC5cbiAgICBgLS1ybWAsIC8vIGF1dG9tYXRpY2FsbHkgcmVtb3ZlIGFmdGVyIGNvbnRhaW5lciBleGlzdHMuXG4gICAgYC0td29ya2RpciAke2NvbnRhaW5lclByb2plY3RQYXRofWAsXG5cbiAgICBgLS12b2x1bWUgJHtyb290UGF0aH06JHtjb250YWluZXJQcm9qZWN0UGF0aH1gLFxuICAgIC8vIGxvY2FsIGRldmVsb3BtZW50IHJlbGF0ZWQgcGF0aHNcbiAgICBgLS12b2x1bWUgJHtkZXZlbG9wbWVudENvZGVGb2xkZXJ9OiR7ZGV2ZWxvcG1lbnRDb2RlRm9sZGVyfWAsXG4gICAgYC0tdm9sdW1lICR7eWFybkxpbmtGb2xyZGVyfToke3lhcm5MaW5rRm9scmRlcn1gLFxuICAgIGAtLXZvbHVtZSAvdmFyL3J1bi9kb2NrZXIuc29jazovdmFyL3J1bi9kb2NrZXIuc29ja2AsXG4gICAgLy8gYC0tdm9sdW1lICR7b3BlcmF0aW5nU3lzdGVtLmhvbWVkaXIoKX0vLnNzaDovcHJvamVjdC8uc3NoYCxcblxuICAgIC8vIGFsbG93IGZvciB1c2luZyBsb2NhbCB1c2VyIG5hbWUgKG9mIGhvc3QgbWFjaGluZSkgdG8gd3JpdGUgZmlsZXMgYW5kIHBlcm1pc3Npb25zIHRocm91Z2ggdGhlIGRvY2tlciBjb250YWluZXIuIGh0dHBzOi8vbWVkaXVtLmNvbS9mYXVuL3NldC1jdXJyZW50LWhvc3QtdXNlci1mb3ItZG9ja2VyLWNvbnRhaW5lci00ZTUyMWNlZjlmZmNcbiAgICBgLS11c2VyICR7b3BlcmF0aW5nU3lzdGVtLnVzZXJJbmZvKCkudWlkfToke29wZXJhdGluZ1N5c3RlbS51c2VySW5mbygpLmdpZH1gLCAvLyB1aWQ6Z2lkXG4gICAgYC0tdm9sdW1lIC9ldGMvcGFzc3dkOi9ldGMvcGFzc3dkOnJvYCxcbiAgICBgLS12b2x1bWUgL2V0Yy9ncm91cDovZXRjL2dyb3VwOnJvYCxcbiAgICBgLS12b2x1bWUgL2V0Yy9zaGFkb3c6L2V0Yy9zaGFkb3c6cm9gLFxuXG4gICAgLy8gY29udGFpbmVyIG5hbWUgaXMgcmVnaXN0ZXJlZCBieSBEb2NrZXIgYXV0b21hdGljYWxseSBmb3Igbm9uIGRlZmF1bHQgbmV0d29ya3MgYXMgaG9zdG5hbWVzIGluIG90aGVyIGNvbnRhaW5lcnMgKGRlZmF1bHQgYnJpZGdlIG5ldHdvcmsgd2lsbCBub3QgdXNlIGhvc3RuYW1lIEROUyksIGFsbG93aW5nIGFjY2VzcyB0byB0aGUgbWVtZ3JhcGggY29udGFpbmVyIHRocm91Z2ggaXQncyBuYW1lLiAoZGVmYXVsdCBuZXR3b3JrIGRvZXNuJ3Qgc3VwcG9ydCBhbGlhc2VzKVxuICAgIGAtLW5ldHdvcms9JHsnZXh0ZXJuYWwnfWAsXG4gICAgYC0tbmV0d29yay1hbGlhcyAkeydhcHBsaWNhdGlvbid9YCwgLy8gbWFrZSBjb250YWluZXIgZGlzY292ZXJhYmxlIGJ5IGFub3RoZXIgaG9zdG5hbWUgaW4gYWRkaXRpb24gdG8gdGhlIGNvbnRhaW5lciBuYW1lIGZvciBzcGVjaWZpYyBuZXR3b3JrLlxuICAgIC8vIGAtLWFkZC1ob3N0IG1lbWdyYXBoOjE3Mi4xNy4wLjNgLFxuXG4gICAgLy8gYC1QYCwgLy8gUHVibGlzaCBhbGwgZXhwb3NlZCBwb3J0cyB0byB0aGUgaG9zdCBpbnRlcmZhY2VzXG4gICAgYC1wIDQ0Mzo0NDMgLXAgODA4MDo4MDgwIC1wIDgwODE6ODA4MSAtcCA4MDgyOjgwODIgLXAgODA4Mzo4MDgzIC1wIDgwODQ6ODA4NCAtcCA4MDg1OjgwODVgLCAvL3NlcnZpY2VzIHBvcnRzXG4gICAgYC1wIDkyMjk6OTIyOWAsIC8vIE5vZGVqcydzIHJlbW90ZSBkZWJ1Z2dlclxuICAgIGAtcCA5MDkwOjkwOTAgLXAgOTkwMTo5OTAxIC1wIDk5MDI6OTkwMmAsIC8vIEJyb3dzZXJzeW5jIGxpdmVyZWxvYWRcblxuICAgIC8qICAnbXl1c2VyaW5kb2NrZXIvZGVwbG95bWVudC1lbnZpcm9ubWVudDpsYXRlc3QnXG4gICAgICAgICdteXVzZXJpbmRvY2tlci9kZXBsb3ltZW50LWVudmlyb25tZW50OnNpbXBsZV9Ob2RlRG9ja2VyQ29tcG9zZSdcbiAgICAgICAgdGhpcyBjb250YWluZXIgc2hvdWxkIGhhdmUgZG9ja2VyIGNsaWVudCAmIGRvY2tlci1jb21wb3NlIGluc3RhbGxlZCBpbi4qL1xuICAgIGAke2RvY2tlckRlcGxveW1lbnRJbWFnZX1gLFxuICAgIHNjcmlwdENvbW1hbmQsXG4gIF1cblxuICBjb25zb2xlLmxvZygnY29udGFpbmVyIGNvbW1hbmQnICsgJzogXFxuJywgc2NyaXB0Q29tbWFuZClcbiAgY29uc29sZS5sb2coYOKAoiBkb2NrZXIgY29tbWFuZDogXCIke2V4ZWN1dGFibGVDb21tYW5kLmpvaW4oJyAnKX1cImApXG5cbiAgbGV0IG9wdGlvbiA9IHtcbiAgICBjd2Q6IHJvb3RQYXRoLFxuICAgIGRldGFjaGVkOiBmYWxzZSxcbiAgICBzaGVsbDogdHJ1ZSxcbiAgICBzdGRpbzogWzAsIDEsIDJdLFxuICAgIC8vIElNUE9SVEFOVDogZ2xvYmFsIGVudmlyb25tZW50IHNob3VsZCBiZSBwYXNzZWQgdG8gYWxsb3cgZm9yIGRvY2tlciBjb21tYW5kcyB0byB3b3JrIGluc2lkZSBub2RlanMgcHJvY2VzcywgYXMgdGhlIFdTTCB1c2VzIGFuIGVudmlyb25tZW50IHZhcmlhYmxlIHRvIGNvbm5lY3QgdG8gdGhlIFdpbmRvd3MgRG9ja2VyIGVuZ2luZSBzb2NrZXQuXG4gICAgZW52OiBPYmplY3QuYXNzaWduKHt9LCBwcm9jZXNzLmVudiwge1xuICAgICAgLy8gREVQTE9ZTUVOVDogJ2RldmVsb3BtZW50JyxcbiAgICB9KSxcbiAgfVxuICBjb25zdCBbY29tbWFuZCwgLi4uY29tbWFuZEFyZ3VtZW50XSA9IGV4ZWN1dGFibGVDb21tYW5kXG4gIHNwYXduU3luYyhjb21tYW5kLCBjb21tYW5kQXJndW1lbnQsIG9wdGlvbilcbn1cblxuLy8gY29tcG9zZSBvcHRpb25zIGh0dHBzOi8vZG9jcy5kb2NrZXIuY29tL2NvbXBvc2UvY29tcG9zZS1maWxlLyNlbnRyeXBvaW50XG4vLyBjb21wb3NlIGNvbW1hbmQgb3B0aW9ucyBodHRwczovL2RvY3MuZG9ja2VyLmNvbS9jb21wb3NlL3JlZmVyZW5jZS9vdmVydmlldy9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkb2NrZXJDb21wb3NlQ2xpKHsgYXBpIC8qIHN1cHBsaWVkIGJ5IHNjcmlwdE1hbmFnZXIgKi8sIHNjcmlwdENvbW1hbmQgPSAnL2Jpbi9iYXNoJyB9ID0ge30pIHtcbiAgY29uc3QgdGFyZ2V0UHJvamVjdENvbmYgPSBhcGkucHJvamVjdC5jb25maWd1cmF0aW9uLmNvbmZpZ3VyYXRpb24sXG4gICAgcm9vdFBhdGggPSBhcGkucHJvamVjdC5jb25maWd1cmF0aW9uLnJvb3RQYXRoLFxuICAgIHRhcmdldFRlbXBvcmFyeUZvbGRlciA9IHBhdGguam9pbihyb290UGF0aCwgJ3RlbXBvcmFyeScpLFxuICAgIGNvbnRhaW5lclByb2plY3RQYXRoID0gcm9vdFBhdGhcblxuICBhd2FpdCBjcmVhdGVEaXJlY3RvcnlSZWN1cnNpdmUodGFyZ2V0VGVtcG9yYXJ5Rm9sZGVyKVxuXG4gIGxldCBvcHRpb24gPSB7XG4gICAgY3dkOiByb290UGF0aCxcbiAgICBkZXRhY2hlZDogZmFsc2UsXG4gICAgc2hlbGw6IHRydWUsXG4gICAgc3RkaW86IFswLCAxLCAyXSxcbiAgICAvLyBJTVBPUlRBTlQ6IGdsb2JhbCBlbnZpcm9ubWVudCBzaG91bGQgYmUgcGFzc2VkIHRvIGFsbG93IGZvciBkb2NrZXIgY29tbWFuZHMgdG8gd29yayBpbnNpZGUgbm9kZWpzIHByb2Nlc3MsIGFzIHRoZSBXU0wgdXNlcyBhbiBlbnZpcm9ubWVudCB2YXJpYWJsZSB0byBjb25uZWN0IHRvIHRoZSBXaW5kb3dzIERvY2tlciBlbmdpbmUgc29ja2V0LlxuICAgIGVudjogT2JqZWN0LmFzc2lnbih7fSwgcHJvY2Vzcy5lbnYsIHtcbiAgICAgIC8vIERFUExPWU1FTlQ6ICdkZXZlbG9wbWVudCcsXG4gICAgfSksXG4gIH1cblxuICBsZXQgcG9ydExpc3QgPSBbXG4gICAgLi4udGFyZ2V0UHJvamVjdENvbmYuYXBpR2F0ZXdheS5zZXJ2aWNlLm1hcChpdGVtID0+IGl0ZW0ucG9ydCkuZmlsdGVyKGl0ZW0gPT4gaXRlbSksXG4gICAgLy8gQWRkaXRpb25hbCBkZXZlbG9wbWVudCBwb3J0c1xuICAgIC4uLltcbiAgICAgIC8vIE5vZGVqcydzIHJlbW90ZSBkZWJ1Z2dlclxuICAgICAgOTIyOSxcbiAgICAgIC8vIEJyb3dzZXJzeW5jIGxpdmVyZWxvYWRcbiAgICAgIDkwOTAsXG4gICAgICA5OTAxLFxuICAgICAgOTkwMixcbiAgICBdLFxuICBdXG4gIGxldCBzZXJ2aWNlQ29uZmlnID0ge1xuICAgIHZlcnNpb246ICczLjcnLFxuXG4gICAgbmV0d29ya3M6IHtcbiAgICAgIGludGVybmFsOiB7XG4gICAgICAgIGRyaXZlcjogJ2JyaWRnZScsIC8vIG5ldHdvcmsgZGlydmVyOiAgYnJpZGdlIGZvciB0aGUgc2FtZSBob3N0LCB3aGlsZSBvdmVybGF5IGlzIGZvciBzd2FybSBob3N0cy5cbiAgICAgIH0sXG4gICAgfSxcblxuICAgIHNlcnZpY2VzOiB7XG4gICAgICBhcHBsaWNhdGlvbjoge1xuICAgICAgICBpbWFnZTogZG9ja2VyRGVwbG95bWVudEltYWdlLFxuXG4gICAgICAgIC8vIGV4cG9ydCBwb3J0cyB0byBob3N0IG1hY2hpbmU6XG4gICAgICAgIC8vIHRvIGNoYW5nZSBwb3J0IGludGVyZmFjZSAoaXApIHVzZSBcIjEyNy4wLjAuMTo4MDo4MFwiXG4gICAgICAgIHBvcnRzOiBwb3J0TGlzdC5tYXAocG9ydCA9PiB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHRhcmdldDogcG9ydCxcbiAgICAgICAgICAgIHB1Ymxpc2hlZDogcG9ydCxcbiAgICAgICAgICAgIC8vIG1vZGU6ICdob3N0JyxcbiAgICAgICAgICB9XG4gICAgICAgIH0pLFxuXG4gICAgICAgIG5ldHdvcmtzOiB7XG4gICAgICAgICAgaW50ZXJuYWw6IHtcbiAgICAgICAgICAgIGFsaWFzZXM6IFsnYXBwbGljYXRpb24nXSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuXG4gICAgICAgIHZvbHVtZXM6IFtcbiAgICAgICAgICBgJHtyb290UGF0aH06JHtjb250YWluZXJQcm9qZWN0UGF0aH1gLFxuICAgICAgICAgIC8vIGxvY2FsIGRldmVsb3BtZW50IHJlbGF0ZWQgcGF0aHNcbiAgICAgICAgICBgJHtkZXZlbG9wbWVudENvZGVGb2xkZXJ9OiR7ZGV2ZWxvcG1lbnRDb2RlRm9sZGVyfWAsXG4gICAgICAgICAgYCR7eWFybkxpbmtGb2xyZGVyfToke3lhcm5MaW5rRm9scmRlcn1gLFxuICAgICAgICAgIGAvdmFyL3J1bi9kb2NrZXIuc29jazovdmFyL3J1bi9kb2NrZXIuc29ja2AsXG5cbiAgICAgICAgICAvLyBhbGxvdyBmb3IgdXNpbmcgbG9jYWwgdXNlciBuYW1lIChvZiBob3N0IG1hY2hpbmUpIHRvIHdyaXRlIGZpbGVzIGFuZCBwZXJtaXNzaW9ucyB0aHJvdWdoIHRoZSBkb2NrZXIgY29udGFpbmVyLiBodHRwczovL21lZGl1bS5jb20vZmF1bi9zZXQtY3VycmVudC1ob3N0LXVzZXItZm9yLWRvY2tlci1jb250YWluZXItNGU1MjFjZWY5ZmZjXG4gICAgICAgICAgYC9ldGMvcGFzc3dkOi9ldGMvcGFzc3dkOnJvYCxcbiAgICAgICAgICBgL2V0Yy9ncm91cDovZXRjL2dyb3VwOnJvYCxcbiAgICAgICAgICBgL2V0Yy9zaGFkb3c6L2V0Yy9zaGFkb3c6cm9gLFxuICAgICAgICBdLFxuXG4gICAgICAgIHVzZXI6IGAke29wZXJhdGluZ1N5c3RlbS51c2VySW5mbygpLnVpZH06JHtvcGVyYXRpbmdTeXN0ZW0udXNlckluZm8oKS5naWR9YCwgLy8gdWlkOmdpZFxuICAgICAgICB3b3JraW5nX2Rpcjogcm9vdFBhdGgsXG4gICAgICAgIC8vIElNUE9SVEFOVDogaWYgZXhlY3V0ZWQgd2l0aCBjb21tYW5kIGAvYmluL3NoIC1jICcnYCwgYXMgZGVmYXVsdCBkb2NrZXIgZG9lcywgdGhlIGludGVycnVwdCBzaWduYWxzIHdpbGwgbm90IGJlIHBhc3NlZCB0byB0aGUgcnVubmluZyBwcm9jZXNzIGFuZCB0aHVzIHdpbGwgbm90IGFib3J0IHRoZSBjb250YWluZXJzLiBUaGVyZWZvcmUgL2Jpbi9iYXNoIC1jIHNob3VsZCBiZSB1c2VkLCBvciBFTlRSWVBPSU5UIGluc3RlYWQgb2YgQ09NTUFORCB3aWxsIHVzZSBiYXNoIGJ5IGRlZmF1bHQuXG4gICAgICAgIC8vIElNUE9SVEFOVDogbm9kZSAtLWV2YWwgZG9lc24ndCBwYXNzIHNpZ25hbHMgY29ycmVjdGx5IGluIGRvY2tlciBjb21tYW5kLCBidXQgd3JhcHBpbmcgaXQgdGhyb3VnaCBucG0gc2NyaXB0cyAoeWFybiBydW4gPHNjcmlwdCBuYW1lPikgYWRkcyBmdW5jdGlvbmFsaXR5LlxuICAgICAgICBjb21tYW5kOiBzY3JpcHRDb21tYW5kLFxuICAgICAgICAvLyBlbnRyeXBvaW50OlxuICAgICAgICAvLyAgIC8vIFsnbm9kZScsIGAtLWV2YWxgLCBgcmVxdWlyZShwcm9jZXNzLmN3ZCgpKS5hcHBsaWNhdGlvbih7fSx7bWVtZ3JhcGg6e2hvc3Q6J21lbWdyYXBoJ319KWBdIHx8IFsneWFybicsICdydW4nLCAncnVuLWNvbmZpZ3VyZWRGb3JDb250YWluZXInXSB8fFxuICAgICAgICAvLyAgIGAke3NjcmlwdENvbW1hbmR9YC5zcGxpdCgnICcpLmZpbHRlcihpdGVtID0+IGl0ZW0ubGVuZ3RoIC8qUmVtb3ZlIGVtcHR5IHZhbHVlcyovKSwgLy8gYC9iaW4vYmFzaCAtYyBcImxzIC1hbFwiYFxuXG4gICAgICAgIC8vIGh0dHBzOi8vZG9jcy5kb2NrZXIuY29tL2NvbXBvc2UvY29tcG9zZS1maWxlLyNkb21haW5uYW1lLWhvc3RuYW1lLWlwYy1tYWNfYWRkcmVzcy1wcml2aWxlZ2VkLXJlYWRfb25seS1zaG1fc2l6ZS1zdGRpbl9vcGVuLXR0eS11c2VyLXdvcmtpbmdfZGlyXG4gICAgICAgIC8vIHdvcmtzIG9ubHkgd2l0aCBkb2NrZXItY29tcG9zZSBydW4gYnV0IGRvZXNuJ3Qgd29yayBmb3Igc29tZSByZWFzb24gd2l0aCBkb2NrZXItY29tcG9zZSB1cCAoc3R1Y2sgb24gJ2F0dGFjaGluZyA8c2VydmljZU5hbWU+Li4nKVxuICAgICAgICB0dHk6IHRydWUsXG4gICAgICAgIHN0ZGluX29wZW46IHRydWUsXG4gICAgICB9LFxuXG4gICAgICBtZW1ncmFwaDoge1xuICAgICAgICBpbWFnZTogJ21lbWdyYXBoOmxhdGVzdCcsXG5cbiAgICAgICAgLy8gZXhwb3J0IHBvcnRzIHRvIGhvc3QgbWFjaGluZTpcbiAgICAgICAgcG9ydHM6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICB0YXJnZXQ6IDc2ODcsXG4gICAgICAgICAgICAvLyBwdWJsaXNoZWQ6IDc2ODcsXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcblxuICAgICAgICBuZXR3b3Jrczoge1xuICAgICAgICAgIGludGVybmFsOiB7XG4gICAgICAgICAgICBhbGlhc2VzOiBbJ21lbWdyYXBoJ10sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSxcbiAgfVxuXG4gIC8vIGNvbnZlcnQgc2VydmljZSBjb25maWd1cmF0aW9uIGludG8geWFtbCBmaWxlIGluIHRlbXBvcmFyeSBsb2NhdGlvbiwgdG8gYmUgdXNlZCBsYXRlciB3aXRoIGRvY2tlci1jb21wb3NlLlxuICBsZXQgeWFtbEZpbGUgPSBwYXRoLmpvaW4odGFyZ2V0VGVtcG9yYXJ5Rm9sZGVyLCAnZG9ja2VyQ29tcG9zZS55YW1sJylcbiAgZmlsZXN5c3RlbS53cml0ZUZpbGVTeW5jKHlhbWxGaWxlLCBqc1lhbWwuZHVtcChzZXJ2aWNlQ29uZmlnLCB7IGxpbmVXaWR0aDogSW5maW5pdHksIG5vQ29tcGF0TW9kZTogdHJ1ZSB9KSlcblxuICBsZXQgZG9ja2VyQ29tcG9zZUNvbW1hbmQgPSBgZG9ja2VyLWNvbXBvc2UgLS1maWxlICR7eWFtbEZpbGV9IC0tcHJvamVjdC1uYW1lIHdlYmFwcFByb2plY3QgLS1sb2ctbGV2ZWwgSU5GT2BcblxuICB7XG4gICAgLy8gTm90ZTogbmVjZXNzYXJ5IHN0ZXAgYXMgcmVjcmVhdGluZyBzZXJ2aWNlcyB3aWxsIHVzZSBwcmV2aW91c2x5IGNyZWF0ZWQgdm9sdW1lcyAoZS5nLiBkYXRhYmFzZSBhbm9ueW1vdXMgdm9sdW1lKVxuICAgIC8vIHN0b3AgYW5kIHJlbW92ZSBjb250YWluZXJzIGFuZCB2b2x1bWVzIHJlbGF0ZWQgdG8gcHJvamVjdCBuYW1lIGZyb20gcHJldmlvdXMgcnVubmluZ1xuICAgIGxldCBleGVjdXRhYmxlQ29tbWFuZCA9IFtcbiAgICAgIFtcbiAgICAgICAgZG9ja2VyQ29tcG9zZUNvbW1hbmQsXG4gICAgICAgICdkb3duIC0tdm9sdW1lcycsIC8vIHJlbW92ZSB2b2x1bWVzIGF0dGFjaGVkIHRvIGNvbnRhaW5lcnMuXG4gICAgICBdLmpvaW4oJyAnKSxcbiAgICBdXG4gICAgY29uc3QgW2NvbW1hbmQsIC4uLmNvbW1hbmRBcmd1bWVudF0gPSBleGVjdXRhYmxlQ29tbWFuZFxuICAgIHNwYXduU3luYyhjb21tYW5kLCBjb21tYW5kQXJndW1lbnQsIG9wdGlvbilcbiAgfVxuXG4gIGxldCBleGVjdXRhYmxlQ29tbWFuZCA9IFtcbiAgICBbXG4gICAgICBkb2NrZXJDb21wb3NlQ29tbWFuZCxcblxuICAgICAgLy8gcnVuOiBhbGxvd3MgYXR0YWNoaW5nIHRvIHRoZSBjb250YWluZXJcbiAgICAgIC8vIHNlcnZpY2UtcG9ydHMgYWxsb3dzIG1hcHBpbmcgb2YgcG9ydHMgdG8gaG9zdCBhcyBzZXQgaW4geW1sIGZpbGUuXG4gICAgICAvLyBgcnVuIC0tcm0gLS1zZXJ2aWNlLXBvcnRzIC0tdXNlLWFsaWFzZXMgYXBwbGljYXRpb25gLFxuXG4gICAgICAvLyB1cFxuICAgICAgLy8gLS1kZXRhY2hcbiAgICAgIGB1cCAtLW5vLWJ1aWxkIC0tZm9yY2UtcmVjcmVhdGUgLS1hYm9ydC1vbi1jb250YWluZXItZXhpdCAtLWFsd2F5cy1yZWNyZWF0ZS1kZXBzYCxcbiAgICBdLmpvaW4oJyAnKSxcbiAgXVxuXG4gIGNvbnNvbGUubG9nKCdjb250YWluZXIgY29tbWFuZCcgKyAnOiBcXG4nLCBzY3JpcHRDb21tYW5kKVxuICBjb25zb2xlLmxvZyhg4oCiIGRvY2tlciBjb21tYW5kOiBcIiR7ZXhlY3V0YWJsZUNvbW1hbmQuam9pbignICcpfVwiYClcbiAgY29uc3QgW2NvbW1hbmQsIC4uLmNvbW1hbmRBcmd1bWVudF0gPSBleGVjdXRhYmxlQ29tbWFuZFxuICBzcGF3blN5bmMoY29tbWFuZCwgY29tbWFuZEFyZ3VtZW50LCBvcHRpb24pXG5cbiAgLy8gZG93bjogYWxsb3dzIHRvIHJlbW92ZSBjb250YWluZXJzIGluIGFkZGl0aW9uIHRvIHN0b3BwaW5nIHRoZW0uXG4gIC8vIFRPRE86IERvZXNuJ3Qgd29yaywgc2VlbXMgcmVsYXRlZCB0byB0aGUgc2lnbmFsIHRyYW5zbWl0aW9uIHRvIHRoZSBwcm9jZXNzIHRocm91Z2ggY29udGFpbmVyIGNvbW1hbmRzLlxuICBwcm9jZXNzLm9uKCdTSUdJTlQnLCAoY29kZSwgc2lnbmFsKSA9PiB7XG4gICAgY29uc29sZS5sb2coYFtQcm9jZXNzICR7cHJvY2Vzcy5waWR9XTogc2lnbmFsICR7c2lnbmFsfSwgY29kZSAke2NvZGV9O2ApXG4gICAgLy8gc3RvcCBhbmQgcmVtb3ZlIGNvbnRhaW5lcnMgcmVsYXRlZCB0byBwcm9qZWN0IG5hbWUuXG4gICAgbGV0IGV4ZWN1dGFibGVDb21tYW5kID0gW1xuICAgICAgW1xuICAgICAgICBkb2NrZXJDb21wb3NlQ29tbWFuZCxcbiAgICAgICAgJ2Rvd24nLFxuICAgICAgICAvLyAtLXZvbHVtZXMgLy9yZW1vdmUgdm9sdW1lcyBhdHRhY2hlZCB0byBjb250YWluZXJzLlxuICAgICAgXS5qb2luKCcgJyksXG4gICAgXVxuICAgIGNvbnN0IFtjb21tYW5kLCAuLi5jb21tYW5kQXJndW1lbnRdID0gZXhlY3V0YWJsZUNvbW1hbmRcbiAgICBzcGF3blN5bmMoY29tbWFuZCwgY29tbWFuZEFyZ3VtZW50LCBvcHRpb24pXG4gIH0pXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkb2NrZXJTdGFja0NsaSh7IGFwaSAvKiBzdXBwbGllZCBieSBzY3JpcHRNYW5hZ2VyICovIH0gPSB7fSkge1xuICBjb25zdCB0YXJnZXRQcm9qZWN0Q29uZiA9IGFwaS5wcm9qZWN0LmNvbmZpZ3VyYXRpb24uY29uZmlndXJhdGlvbixcbiAgICByb290UGF0aCA9IGFwaS5wcm9qZWN0LmNvbmZpZ3VyYXRpb24ucm9vdFBhdGgsXG4gICAgdGFyZ2V0VGVtcG9yYXJ5Rm9sZGVyID0gcGF0aC5qb2luKHJvb3RQYXRoLCAndGVtcG9yYXJ5JyksXG4gICAgY29udGFpbmVyUHJvamVjdFBhdGggPSByb290UGF0aCxcbiAgICB0YXJnZXRQYWNrYWdlUGF0aCA9IHBhdGguam9pbihyb290UGF0aCwgJ3BhY2thZ2UuanNvbicpXG4gIGNvbnN0IHBhY2thZ2VDb25maWcgPSBtb2RpZnlKc29uLnJlYWRGaWxlU3luYyh0YXJnZXRQYWNrYWdlUGF0aClcbiAgbGV0IHByb2plY3ROYW1lID0gcGFja2FnZUNvbmZpZy5uYW1lLnN1YnN0cmluZyhwYWNrYWdlQ29uZmlnLm5hbWUubGFzdEluZGV4T2YoJy8nKSArIDEpIC8vIHBhY2thZ2UgbmFtZSBgQG5hbWVzcGFjZS9wYWNrYWdlTmFtZWAgPT4gYHBhY2thZ2VOYW1lYFxuICBsZXQgaW1hZ2VOYW1lID0gcHJvamVjdE5hbWUgfD4gY29udmVydFRvUGFyYW1DYXNlIC8vIHBhY2thZ2UgbmFtZSBgQG5hbWVzcGFjZS9wYWNrYWdlTmFtZWAgPT4gYHBhY2thZ2VOYW1lYCA9PiBkb2NrZXIgaW1hZ2UgbmFtZSBwYXJhbSBjYXNlIGBwYWNrYWdlLW5hbWVgXG5cbiAgYXdhaXQgY3JlYXRlRGlyZWN0b3J5UmVjdXJzaXZlKHRhcmdldFRlbXBvcmFyeUZvbGRlcilcblxuICBsZXQgb3B0aW9uID0ge1xuICAgIGN3ZDogcm9vdFBhdGgsXG4gICAgZGV0YWNoZWQ6IGZhbHNlLFxuICAgIHNoZWxsOiB0cnVlLFxuICAgIHN0ZGlvOiBbMCwgMSwgMl0sXG4gICAgLy8gSU1QT1JUQU5UOiBnbG9iYWwgZW52aXJvbm1lbnQgc2hvdWxkIGJlIHBhc3NlZCB0byBhbGxvdyBmb3IgZG9ja2VyIGNvbW1hbmRzIHRvIHdvcmsgaW5zaWRlIG5vZGVqcyBwcm9jZXNzLCBhcyB0aGUgV1NMIHVzZXMgYW4gZW52aXJvbm1lbnQgdmFyaWFibGUgdG8gY29ubmVjdCB0byB0aGUgV2luZG93cyBEb2NrZXIgZW5naW5lIHNvY2tldC5cbiAgICBlbnY6IE9iamVjdC5hc3NpZ24oe30sIHByb2Nlc3MuZW52LCB7XG4gICAgICAvLyBERVBMT1lNRU5UOiAnZGV2ZWxvcG1lbnQnLFxuICAgIH0pLFxuICB9XG5cbiAgbGV0IHBvcnRMaXN0ID0gW1xuICAgIC4uLnRhcmdldFByb2plY3RDb25mLmFwaUdhdGV3YXkuc2VydmljZS5tYXAoaXRlbSA9PiBpdGVtLnBvcnQpLmZpbHRlcihpdGVtID0+IGl0ZW0pLFxuICAgIC8vIEFkZGl0aW9uYWwgZGV2ZWxvcG1lbnQgcG9ydHNcbiAgICAuLi5bXG4gICAgICAvLyBOb2RlanMncyByZW1vdGUgZGVidWdnZXJcbiAgICAgIDkyMjksXG4gICAgICAvLyBCcm93c2Vyc3luYyBsaXZlcmVsb2FkXG4gICAgICA5MDkwLFxuICAgICAgOTkwMSxcbiAgICAgIDk5MDIsXG4gICAgXSxcbiAgXVxuICBsZXQgc2VydmljZUNvbmZpZyA9IHtcbiAgICB2ZXJzaW9uOiAnMy43JyxcblxuICAgIG5ldHdvcmtzOiB7XG4gICAgICBvdmVybGF5OiB7XG4gICAgICAgIGRyaXZlcjogJ292ZXJsYXknLCAvLyBuZXR3b3JrIGRpcnZlcjogIGJyaWRnZSBmb3IgdGhlIHNhbWUgaG9zdCwgd2hpbGUgb3ZlcmxheSBpcyBmb3Igc3dhcm0gaG9zdHMuXG4gICAgICB9LFxuICAgIH0sXG5cbiAgICBzZXJ2aWNlczoge1xuICAgICAgYXBwbGljYXRpb246IHtcbiAgICAgICAgaW1hZ2U6IGBteXVzZXJpbmRvY2tlci8ke2ltYWdlTmFtZX06bGF0ZXN0YCxcblxuICAgICAgICAvLyBleHBvcnQgcG9ydHMgdG8gaG9zdCBtYWNoaW5lOlxuICAgICAgICAvLyB0byBjaGFuZ2UgcG9ydCBpbnRlcmZhY2UgKGlwKSB1c2UgXCIxMjcuMC4wLjE6ODA6ODBcIlxuICAgICAgICBwb3J0czogcG9ydExpc3QubWFwKHBvcnQgPT4ge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0YXJnZXQ6IHBvcnQsXG4gICAgICAgICAgICBwdWJsaXNoZWQ6IHBvcnQsXG4gICAgICAgICAgICAvLyBtb2RlOiAnaG9zdCcsXG4gICAgICAgICAgfVxuICAgICAgICB9KSxcblxuICAgICAgICBuZXR3b3Jrczoge1xuICAgICAgICAgIG92ZXJsYXk6IHtcbiAgICAgICAgICAgIGFsaWFzZXM6IFsnYXBwbGljYXRpb24nXSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuXG4gICAgICAgIHZvbHVtZXM6IFtcbiAgICAgICAgICAvLyBwcm9kdWN0aW9uIHN0b3JhZ2VcbiAgICAgICAgXSxcblxuICAgICAgICBkZXBsb3k6IHtcbiAgICAgICAgICByZXBsaWNhczogMSxcbiAgICAgICAgICAvLyBjb25zdHJhaW50cyAtIE5PVEU6IHdpbGwgbm90IHJ1biB1bnRpbCBjb25zdGFpbnRzIG1ldC5cbiAgICAgICAgICAvLyBwbGFjZW1lbnQ6IHtcbiAgICAgICAgICAvLyAgIGNvbnN0cmFpbnRzOiBbJ25vZGUucm9sZSA9PSBzZXJ2aWNlJ10sIC8vIGNvbnRhaW5lcnMgYXJlIGNsYXNzaWZpZWQgaW50byAnc2VydmljZScgb3IgJ21hbmFnZXInIC0gaS5lLiBhcHBsaWNhaXRvbiByZWxhdGVkIG9yIHRvb2wgcmVsYXRlZCBmb3IgbWFuYWdlbWVudC5cbiAgICAgICAgICAvLyB9LFxuICAgICAgICAgIHVwZGF0ZV9jb25maWc6IHtcbiAgICAgICAgICAgIHBhcmFsbGVsaXNtOiAxLFxuICAgICAgICAgICAgZGVsYXk6ICcxMHMnLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcmVzdGFydF9wb2xpY3k6IHtcbiAgICAgICAgICAgIGNvbmRpdGlvbjogJ29uLWZhaWx1cmUnIHx8ICdhbnknLFxuICAgICAgICAgICAgZGVsYXk6ICcycycsXG4gICAgICAgICAgICAvLyBtYXhfYXR0ZW1wdHM6IDMsXG4gICAgICAgICAgICAvLyB3aW5kb3c6ICcxMjBzJyxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuXG4gICAgICAgIC8vIGVudHJ5cG9pbnQ6IFsnbm9kZSddLFxuICAgICAgICAvLyBjb21tYW5kOiBgLS1ldmFsIFwicmVxdWlyZShwcm9jZXNzLmN3ZCgpKS5hcHBsaWNhdGlvbih7fSwgeyBtZW1ncmFwaDogeyBob3N0OiAnbWVtZ3JhcGgnIH19KVwiYCxcblxuICAgICAgICAvLyBodHRwczovL2RvY3MuZG9ja2VyLmNvbS9jb21wb3NlL2NvbXBvc2UtZmlsZS8jZG9tYWlubmFtZS1ob3N0bmFtZS1pcGMtbWFjX2FkZHJlc3MtcHJpdmlsZWdlZC1yZWFkX29ubHktc2htX3NpemUtc3RkaW5fb3Blbi10dHktdXNlci13b3JraW5nX2RpclxuICAgICAgICAvLyB3b3JrcyBvbmx5IHdpdGggZG9ja2VyLWNvbXBvc2UgcnVuIGJ1dCBkb2Vzbid0IHdvcmsgZm9yIHNvbWUgcmVhc29uIHdpdGggZG9ja2VyLWNvbXBvc2UgdXAgKHN0dWNrIG9uICdhdHRhY2hpbmcgPHNlcnZpY2VOYW1lPi4uJylcbiAgICAgICAgdHR5OiB0cnVlLFxuICAgICAgICBzdGRpbl9vcGVuOiB0cnVlLFxuICAgICAgfSxcblxuICAgICAgbWVtZ3JhcGg6IHtcbiAgICAgICAgaW1hZ2U6ICdtZW1ncmFwaDpsYXRlc3QnLFxuXG4gICAgICAgIC8vIGV4cG9ydCBwb3J0cyB0byBob3N0IG1hY2hpbmU6XG4gICAgICAgIHBvcnRzOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgdGFyZ2V0OiA3Njg3LFxuICAgICAgICAgICAgLy8gcHVibGlzaGVkOiA3Njg3LFxuICAgICAgICAgIH0sXG4gICAgICAgIF0sXG5cbiAgICAgICAgbmV0d29ya3M6IHtcbiAgICAgICAgICBvdmVybGF5OiB7XG4gICAgICAgICAgICBhbGlhc2VzOiBbJ21lbWdyYXBoJ10sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSxcbiAgfVxuXG4gIC8vIGNvbnZlcnQgc2VydmljZSBjb25maWd1cmF0aW9uIGludG8geWFtbCBmaWxlIGluIHRlbXBvcmFyeSBsb2NhdGlvbiwgdG8gYmUgdXNlZCBsYXRlciB3aXRoIGRvY2tlci1jb21wb3NlLlxuICBsZXQgeWFtbEZpbGUgPSBwYXRoLmpvaW4odGFyZ2V0VGVtcG9yYXJ5Rm9sZGVyLCAnZG9ja2VyU3RhY2sueWFtbCcpXG4gIGZpbGVzeXN0ZW0ud3JpdGVGaWxlU3luYyh5YW1sRmlsZSwganNZYW1sLmR1bXAoc2VydmljZUNvbmZpZywgeyBsaW5lV2lkdGg6IEluZmluaXR5LCBub0NvbXBhdE1vZGU6IHRydWUgfSkpXG5cbiAgbGV0IGRvY2tlclN0YWNrQ29tbWFuZCA9IGBkb2NrZXIgLS1sb2ctbGV2ZWwgSU5GT2BcblxuICAvLyB7XG4gIC8vICAgLy8gTm90ZTogbmVjZXNzYXJ5IHN0ZXAgYXMgcmVjcmVhdGluZyBzZXJ2aWNlcyB3aWxsIHVzZSBwcmV2aW91c2x5IGNyZWF0ZWQgdm9sdW1lcyAoZS5nLiBkYXRhYmFzZSBhbm9ueW1vdXMgdm9sdW1lKVxuICAvLyAgIC8vIHN0b3AgYW5kIHJlbW92ZSBjb250YWluZXJzIGFuZCB2b2x1bWVzIHJlbGF0ZWQgdG8gcHJvamVjdCBuYW1lIGZyb20gcHJldmlvdXMgcnVubmluZ1xuICAvLyAgIHNwYXduU3luYyhkb2NrZXJTdGFja0NvbW1hbmQsIFtgc3RhY2sgLS1vcmNoZXN0cmF0b3Igc3dhcm0gcm0gYXBwbGljYXRpb25gXSwgb3B0aW9uKVxuICAvLyB9XG5cbiAgLy8gLS1uYW1lc3BhY2UgaXMgb25seSBmb3IgS3ViZXJuYXRlcywgLS1wcnVuZVxuICBsZXQgZXhlY3V0YWJsZUNvbW1hbmQgPSBbW2RvY2tlclN0YWNrQ29tbWFuZCwgYHN0YWNrIC0tb3JjaGVzdHJhdG9yIHN3YXJtIGRlcGxveSAtLWNvbXBvc2UtZmlsZSAke3lhbWxGaWxlfSAtLXJlc29sdmUtaW1hZ2UgY2hhbmdlZCBhcHBsaWNhdGlvbmBdLmpvaW4oJyAnKV1cblxuICBjb25zb2xlLmxvZyhg4oCiIGRvY2tlciBjb21tYW5kOiBcIiR7ZXhlY3V0YWJsZUNvbW1hbmQuam9pbignICcpfVwiYClcbiAgY29uc3QgW2NvbW1hbmQsIC4uLmNvbW1hbmRBcmd1bWVudF0gPSBleGVjdXRhYmxlQ29tbWFuZFxuICBzcGF3blN5bmMoY29tbWFuZCwgY29tbWFuZEFyZ3VtZW50LCBvcHRpb24pXG5cbiAgLy8gLy8gc3RvcCBhbmQgcmVtb3ZlIGNvbnRhaW5lcnMgcmVsYXRlZCB0byBwcm9qZWN0IG5hbWUuXG4gIC8vIC8vIFRPRE86IERvZXNuJ3Qgd29yaywgc2VlbXMgcmVsYXRlZCB0byB0aGUgc2lnbmFsIHRyYW5zbWl0aW9uIHRvIHRoZSBwcm9jZXNzIHRocm91Z2ggY29udGFpbmVyIGNvbW1hbmRzLlxuICAvLyBwcm9jZXNzLm9uKCdTSUdJTlQnLCAoY29kZSwgc2lnbmFsKSA9PiB7XG4gIC8vICAgY29uc29sZS5sb2coYFtQcm9jZXNzICR7cHJvY2Vzcy5waWR9XTogc2lnbmFsICR7c2lnbmFsfSwgY29kZSAke2NvZGV9O2ApXG4gIC8vICAgc3Bhd25TeW5jKGRvY2tlclN0YWNrQ29tbWFuZCwgW2BzdGFjayAtLW9yY2hlc3RyYXRvciBzd2FybSBybSBhcHBsaWNhdGlvbmBdLCBvcHRpb24pXG4gIC8vIH0pXG59XG4iXX0=