"use strict";var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports, "__esModule", { value: true });exports.dockerCli = dockerCli;exports.dockerComposeCli = dockerComposeCli;var _child_process = require("child_process");
var _os = _interopRequireDefault(require("os"));
var _path = _interopRequireDefault(require("path"));
var _fs = _interopRequireDefault(require("fs"));



var jsYaml = _interopRequireWildcard(require("js-yaml"));
var _handleFilesystemOperation = require("@dependency/handleFilesystemOperation");

const developmentCodeFolder = _path.default.join(_os.default.homedir(), 'code'),
yarnLinkFolrder = _path.default.join(_os.default.homedir(), '.config');

async function dockerCli({ api, scriptCommand = '/bin/bash' } = {}) {
  const applicationPath = _path.default.join(api.project.configuration.rootPath, 'entrypoint/cli'),
  rootPath = api.project.configuration.rootPath,
  containerProjectPath = rootPath;

  let executableCommand = [
  'docker',
  `run`,




  '--init',
  '--sig-proxy',
  `--interactive --tty`,
  `--rm`,
  `--workdir ${containerProjectPath}`,

  `--volume ${rootPath}:${containerProjectPath}`,

  `--volume ${developmentCodeFolder}:${developmentCodeFolder}`,
  `--volume ${yarnLinkFolrder}:${yarnLinkFolrder}`,
  `--volume /var/run/docker.sock:/var/run/docker.sock`,



  `--network=${'external'}`,
  `--network-alias ${'application'}`,



  `-p 443:443 -p 8080:8080 -p 8081:8081 -p 8082:8082 -p 8083:8083 -p 8084:8084 -p 8085:8085`,
  `-p 9229:9229`,
  `-p 9090:9090 -p 9901:9901 -p 9902:9902`,




  `${'node:current'}`,
  scriptCommand];


  console.log('container command' + ': \n', scriptCommand);
  console.log(`• docker command: "${executableCommand.join(' ')}"`);

  let option = {
    cwd: rootPath,
    detached: false,
    shell: true,
    stdio: [0, 1, 2],

    env: Object.assign({}, process.env, {}) };



  const [command, ...commandArgument] = executableCommand;
  (0, _child_process.spawnSync)(command, commandArgument, option);
}



async function dockerComposeCli({ api, scriptCommand = '/bin/bash' } = {}) {
  const targetProjectConf = api.project.configuration.configuration,
  rootPath = api.project.configuration.rootPath,
  targetTemporaryFolder = _path.default.join(rootPath, 'temporary'),
  containerProjectPath = rootPath;

  await (0, _handleFilesystemOperation.recursiveCreateDirectory)({ directoryPath: targetTemporaryFolder });

  let option = {
    cwd: rootPath,
    detached: false,
    shell: true,
    stdio: [0, 1, 2],

    env: Object.assign({}, process.env, {}) };




  let portList = [
  ...targetProjectConf.apiGateway.service.map(item => item.port).filter(item => item),

  ...[

  9229,

  9090,
  9901,
  9902]];


  let serviceConfig = {
    version: '3.7',

    networks: {
      internal: {
        driver: 'bridge' } },



    services: {
      application: {
        image: 'node:current',



        ports: portList.map(port => {
          return {
            target: port,
            published: port };


        }),

        volumes: [
        `${rootPath}:${containerProjectPath}`,

        `${developmentCodeFolder}:${developmentCodeFolder}`,
        `${yarnLinkFolrder}:${yarnLinkFolrder}`,
        `/var/run/docker.sock:/var/run/docker.sock`],


        networks: {
          internal: {
            aliases: ['application'] } },



        working_dir: rootPath,


        command: scriptCommand,






        tty: true,
        stdin_open: true },


      memgraph: {
        image: 'memgraph:latest',


        ports: [
        {
          target: 7687 }],




        networks: {
          internal: {
            aliases: ['memgraph'] } } } } };







  let yamlFile = _path.default.join(targetTemporaryFolder, 'dockerCompose.yaml');
  _fs.default.writeFileSync(yamlFile, jsYaml.dump(serviceConfig, { lineWidth: Infinity, noCompatMode: true }));

  let dockerComposeCommand = `docker-compose --file ${yamlFile} --project-name webappProject --log-level INFO`;

  {


    let executableCommand = [
    [
    dockerComposeCommand,
    'down --volumes'].
    join(' ')];

    const [command, ...commandArgument] = executableCommand;
    (0, _child_process.spawnSync)(command, commandArgument, option);
  }

  let executableCommand = [
  [
  dockerComposeCommand,







  `up --no-build --force-recreate --abort-on-container-exit --always-recreate-deps`].
  join(' ')];


  console.log('container command' + ': \n', scriptCommand);
  console.log(`• docker command: "${executableCommand.join(' ')}"`);
  const [command, ...commandArgument] = executableCommand;
  (0, _child_process.spawnSync)(command, commandArgument, option);



  process.on('SIGINT', (code, signal) => {
    console.log(`[Process ${process.pid}]: signal ${signal}, code ${code};`);

    let executableCommand = [
    [
    dockerComposeCommand,
    'down'].

    join(' ')];

    const [command, ...commandArgument] = executableCommand;
    (0, _child_process.spawnSync)(command, commandArgument, option);
  });
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NvdXJjZS9KU1Byb2plY3QvY29udGFpbmVyL3J1bi5qcyJdLCJuYW1lcyI6WyJkZXZlbG9wbWVudENvZGVGb2xkZXIiLCJwYXRoIiwiam9pbiIsIm9wZXJhdGluZ1N5c3RlbSIsImhvbWVkaXIiLCJ5YXJuTGlua0ZvbHJkZXIiLCJkb2NrZXJDbGkiLCJhcGkiLCJzY3JpcHRDb21tYW5kIiwiYXBwbGljYXRpb25QYXRoIiwicHJvamVjdCIsImNvbmZpZ3VyYXRpb24iLCJyb290UGF0aCIsImNvbnRhaW5lclByb2plY3RQYXRoIiwiZXhlY3V0YWJsZUNvbW1hbmQiLCJjb25zb2xlIiwibG9nIiwib3B0aW9uIiwiY3dkIiwiZGV0YWNoZWQiLCJzaGVsbCIsInN0ZGlvIiwiZW52IiwiT2JqZWN0IiwiYXNzaWduIiwicHJvY2VzcyIsImNvbW1hbmQiLCJjb21tYW5kQXJndW1lbnQiLCJkb2NrZXJDb21wb3NlQ2xpIiwidGFyZ2V0UHJvamVjdENvbmYiLCJ0YXJnZXRUZW1wb3JhcnlGb2xkZXIiLCJkaXJlY3RvcnlQYXRoIiwicG9ydExpc3QiLCJhcGlHYXRld2F5Iiwic2VydmljZSIsIm1hcCIsIml0ZW0iLCJwb3J0IiwiZmlsdGVyIiwic2VydmljZUNvbmZpZyIsInZlcnNpb24iLCJuZXR3b3JrcyIsImludGVybmFsIiwiZHJpdmVyIiwic2VydmljZXMiLCJhcHBsaWNhdGlvbiIsImltYWdlIiwicG9ydHMiLCJ0YXJnZXQiLCJwdWJsaXNoZWQiLCJ2b2x1bWVzIiwiYWxpYXNlcyIsIndvcmtpbmdfZGlyIiwidHR5Iiwic3RkaW5fb3BlbiIsIm1lbWdyYXBoIiwieWFtbEZpbGUiLCJmaWxlc3lzdGVtIiwid3JpdGVGaWxlU3luYyIsImpzWWFtbCIsImR1bXAiLCJsaW5lV2lkdGgiLCJJbmZpbml0eSIsIm5vQ29tcGF0TW9kZSIsImRvY2tlckNvbXBvc2VDb21tYW5kIiwib24iLCJjb2RlIiwic2lnbmFsIiwicGlkIl0sIm1hcHBpbmdzIjoi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QyxlQUFuQixFQUFvQ1YsTUFBcEM7QUFDRDs7QUFFRCxNQUFJSCxpQkFBaUIsR0FBRztBQUN0QjtBQUNFa0QsRUFBQUEsb0JBREY7Ozs7Ozs7O0FBU0csbUZBVEg7QUFVRTlELEVBQUFBLElBVkYsQ0FVTyxHQVZQLENBRHNCLENBQXhCOzs7QUFjQWEsRUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVksc0JBQXNCLE1BQWxDLEVBQTBDUixhQUExQztBQUNBTyxFQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBYSxzQkFBcUJGLGlCQUFpQixDQUFDWixJQUFsQixDQUF1QixHQUF2QixDQUE0QixHQUE5RDtBQUNBLFFBQU0sQ0FBQ3dCLE9BQUQsRUFBVSxHQUFHQyxlQUFiLElBQWdDYixpQkFBdEM7QUFDQSxnQ0FBVVksT0FBVixFQUFtQkMsZUFBbkIsRUFBb0NWLE1BQXBDOzs7O0FBSUFRLEVBQUFBLE9BQU8sQ0FBQ3dDLEVBQVIsQ0FBVyxRQUFYLEVBQXFCLENBQUNDLElBQUQsRUFBT0MsTUFBUCxLQUFrQjtBQUNyQ3BELElBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFhLFlBQVdTLE9BQU8sQ0FBQzJDLEdBQUksYUFBWUQsTUFBTyxVQUFTRCxJQUFLLEdBQXJFOztBQUVBLFFBQUlwRCxpQkFBaUIsR0FBRztBQUN0QjtBQUNFa0QsSUFBQUEsb0JBREY7QUFFRSxVQUZGOztBQUlFOUQsSUFBQUEsSUFKRixDQUlPLEdBSlAsQ0FEc0IsQ0FBeEI7O0FBT0EsVUFBTSxDQUFDd0IsT0FBRCxFQUFVLEdBQUdDLGVBQWIsSUFBZ0NiLGlCQUF0QztBQUNBLGtDQUFVWSxPQUFWLEVBQW1CQyxlQUFuQixFQUFvQ1YsTUFBcEM7QUFDRCxHQVpEO0FBYUQiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBleGVjU3luYywgc3Bhd24sIHNwYXduU3luYyB9IGZyb20gJ2NoaWxkX3Byb2Nlc3MnXG5pbXBvcnQgb3BlcmF0aW5nU3lzdGVtIGZyb20gJ29zJ1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCdcbmltcG9ydCBmaWxlc3lzdGVtIGZyb20gJ2ZzJ1xuaW1wb3J0IGFzc2VydCBmcm9tICdhc3NlcnQnXG5pbXBvcnQgcmVzb2x2ZSBmcm9tICdyZXNvbHZlJyAvLyB1c2UgJ3Jlc29sdmUnIG1vZHVsZSB0byBhbGxvdyBwYXNzaW5nICdwcmVzZXJ2ZSBzeW1saW5rcycgb3B0aW9uIHRoYXQgaXMgbm90IHN1cHBvcnRlZCBieSByZXF1aXJlLnJlc29sdmUgbW9kdWxlLlxuaW1wb3J0ICogYXMgZG9ja2Vyb2RlIGZyb20gJ2RvY2tlcm9kZSdcbmltcG9ydCAqIGFzIGpzWWFtbCBmcm9tICdqcy15YW1sJ1xuaW1wb3J0IHsgcmVjdXJzaXZlQ3JlYXRlRGlyZWN0b3J5IH0gZnJvbSAnQGRlcGVuZGVuY3kvaGFuZGxlRmlsZXN5c3RlbU9wZXJhdGlvbidcbi8vIHdoaWxlIGRldmVsb3BpbmcsIGFsbG93IGRlcGVuZGVuY3kgc3ltbGlua3MgdG8gd29yayBpbiBjb250YWluZXJzLlxuY29uc3QgZGV2ZWxvcG1lbnRDb2RlRm9sZGVyID0gcGF0aC5qb2luKG9wZXJhdGluZ1N5c3RlbS5ob21lZGlyKCksICdjb2RlJyksXG4gIHlhcm5MaW5rRm9scmRlciA9IHBhdGguam9pbihvcGVyYXRpbmdTeXN0ZW0uaG9tZWRpcigpLCAnLmNvbmZpZycpXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkb2NrZXJDbGkoeyBhcGkgLyogc3VwcGxpZWQgYnkgc2NyaXB0TWFuYWdlciAqLywgc2NyaXB0Q29tbWFuZCA9ICcvYmluL2Jhc2gnIH0gPSB7fSkge1xuICBjb25zdCBhcHBsaWNhdGlvblBhdGggPSBwYXRoLmpvaW4oYXBpLnByb2plY3QuY29uZmlndXJhdGlvbi5yb290UGF0aCwgJ2VudHJ5cG9pbnQvY2xpJyksXG4gICAgcm9vdFBhdGggPSBhcGkucHJvamVjdC5jb25maWd1cmF0aW9uLnJvb3RQYXRoLFxuICAgIGNvbnRhaW5lclByb2plY3RQYXRoID0gcm9vdFBhdGhcblxuICBsZXQgZXhlY3V0YWJsZUNvbW1hbmQgPSBbXG4gICAgJ2RvY2tlcicsXG4gICAgYHJ1bmAsXG5cbiAgICAvLyBgLS1uYW1lICR7J3Byb2plY3QnfWAsXG5cbiAgICAvLyAtLWV4cGVyaW1lbnRhbC1tb2R1bGVzIC0taW5wdXQtdHlwZT1jb21tb25qXG4gICAgJy0taW5pdCcsIC8vIEZpeGVzIHNpZ25hbCBoYW5kbGVycyAmIHJlYXBpbmcgKHByb2Nlc3Mgb2YgZWxpbWluYXRpbmcgem9tYmllIHByb2Nlc3NlcykuICBodHRwczovL2dpdGh1Yi5jb20va3JhbGxpbi90aW5pIGh0dHBzOi8vZ2l0aHViLmNvbS9kb2NrZXIvY2xpL3B1bGwvMTg0MVxuICAgICctLXNpZy1wcm94eScsIC8vIHBhc3Mgc2lnbmFsc1xuICAgIGAtLWludGVyYWN0aXZlIC0tdHR5YCwgLy8gYWxsb2NhdGUgYSB0ZXJtaW5hbCAtIHRoaXMgYWxsb3dzIGZvciBpbnRlcmFjdGluZyB3aXRoIHRoZSBjb250YWluZXIgcHJvY2Vzcy4gdHR5ID0gVW5peC9MaW51eCB0ZXJtaW5hbCBhY2Nlc3MgaGFuZGxpbmcgdXNpbmcgbW9kZW0gYmFzZWQgY29ubmVjdGlvbiAoYWxsb3dzIGlucHV0IGZyb20gdGVybWluYWwpLCBpdGVyYWN0aXZlID0gYWNjZXB0cyBpbnB1dCBmcm9tIGhvc3QuXG4gICAgYC0tcm1gLCAvLyBhdXRvbWF0aWNhbGx5IHJlbW92ZSBhZnRlciBjb250YWluZXIgZXhpc3RzLlxuICAgIGAtLXdvcmtkaXIgJHtjb250YWluZXJQcm9qZWN0UGF0aH1gLFxuXG4gICAgYC0tdm9sdW1lICR7cm9vdFBhdGh9OiR7Y29udGFpbmVyUHJvamVjdFBhdGh9YCxcbiAgICAvLyBsb2NhbCBkZXZlbG9wbWVudCByZWxhdGVkIHBhdGhzXG4gICAgYC0tdm9sdW1lICR7ZGV2ZWxvcG1lbnRDb2RlRm9sZGVyfToke2RldmVsb3BtZW50Q29kZUZvbGRlcn1gLFxuICAgIGAtLXZvbHVtZSAke3lhcm5MaW5rRm9scmRlcn06JHt5YXJuTGlua0ZvbHJkZXJ9YCxcbiAgICBgLS12b2x1bWUgL3Zhci9ydW4vZG9ja2VyLnNvY2s6L3Zhci9ydW4vZG9ja2VyLnNvY2tgLFxuICAgIC8vIGAtLXZvbHVtZSAke29wZXJhdGluZ1N5c3RlbS5ob21lZGlyKCl9Ly5zc2g6L3Byb2plY3QvLnNzaGAsXG5cbiAgICAvLyBjb250YWluZXIgbmFtZSBpcyByZWdpc3RlcmVkIGJ5IERvY2tlciBhdXRvbWF0aWNhbGx5IGZvciBub24gZGVmYXVsdCBuZXR3b3JrcyBhcyBob3N0bmFtZXMgaW4gb3RoZXIgY29udGFpbmVycyAoZGVmYXVsdCBicmlkZ2UgbmV0d29yayB3aWxsIG5vdCB1c2UgaG9zdG5hbWUgRE5TKSwgYWxsb3dpbmcgYWNjZXNzIHRvIHRoZSBtZW1ncmFwaCBjb250YWluZXIgdGhyb3VnaCBpdCdzIG5hbWUuIChkZWZhdWx0IG5ldHdvcmsgZG9lc24ndCBzdXBwb3J0IGFsaWFzZXMpXG4gICAgYC0tbmV0d29yaz0keydleHRlcm5hbCd9YCxcbiAgICBgLS1uZXR3b3JrLWFsaWFzICR7J2FwcGxpY2F0aW9uJ31gLCAvLyBtYWtlIGNvbnRhaW5lciBkaXNjb3ZlcmFibGUgYnkgYW5vdGhlciBob3N0bmFtZSBpbiBhZGRpdGlvbiB0byB0aGUgY29udGFpbmVyIG5hbWUgZm9yIHNwZWNpZmljIG5ldHdvcmsuXG4gICAgLy8gYC0tYWRkLWhvc3QgbWVtZ3JhcGg6MTcyLjE3LjAuM2AsXG5cbiAgICAvLyBgLVBgLCAvLyBQdWJsaXNoIGFsbCBleHBvc2VkIHBvcnRzIHRvIHRoZSBob3N0IGludGVyZmFjZXNcbiAgICBgLXAgNDQzOjQ0MyAtcCA4MDgwOjgwODAgLXAgODA4MTo4MDgxIC1wIDgwODI6ODA4MiAtcCA4MDgzOjgwODMgLXAgODA4NDo4MDg0IC1wIDgwODU6ODA4NWAsIC8vc2VydmljZXMgcG9ydHNcbiAgICBgLXAgOTIyOTo5MjI5YCwgLy8gTm9kZWpzJ3MgcmVtb3RlIGRlYnVnZ2VyXG4gICAgYC1wIDkwOTA6OTA5MCAtcCA5OTAxOjk5MDEgLXAgOTkwMjo5OTAyYCwgLy8gQnJvd3NlcnN5bmMgbGl2ZXJlbG9hZFxuXG4gICAgLyogICdteXVzZXJpbmRvY2tlci9kZXBsb3ltZW50LWVudmlyb25tZW50OmxhdGVzdCdcbiAgICAgICAgJ215dXNlcmluZG9ja2VyL2RlcGxveW1lbnQtZW52aXJvbm1lbnQ6c2ltcGxlX05vZGVEb2NrZXJDb21wb3NlJ1xuICAgICAgICB0aGlzIGNvbnRhaW5lciBzaG91bGQgaGF2ZSBkb2NrZXIgY2xpZW50ICYgZG9ja2VyLWNvbXBvc2UgaW5zdGFsbGVkIGluLiovXG4gICAgYCR7J25vZGU6Y3VycmVudCd9YCwgLy8gbm9kZWpzIDEyIHRvIHN1cHBvcnQgbm9kZWdpdFxuICAgIHNjcmlwdENvbW1hbmQsXG4gIF1cblxuICBjb25zb2xlLmxvZygnY29udGFpbmVyIGNvbW1hbmQnICsgJzogXFxuJywgc2NyaXB0Q29tbWFuZClcbiAgY29uc29sZS5sb2coYOKAoiBkb2NrZXIgY29tbWFuZDogXCIke2V4ZWN1dGFibGVDb21tYW5kLmpvaW4oJyAnKX1cImApXG5cbiAgbGV0IG9wdGlvbiA9IHtcbiAgICBjd2Q6IHJvb3RQYXRoLFxuICAgIGRldGFjaGVkOiBmYWxzZSxcbiAgICBzaGVsbDogdHJ1ZSxcbiAgICBzdGRpbzogWzAsIDEsIDJdLFxuICAgIC8vIElNUE9SVEFOVDogZ2xvYmFsIGVudmlyb25tZW50IHNob3VsZCBiZSBwYXNzZWQgdG8gYWxsb3cgZm9yIGRvY2tlciBjb21tYW5kcyB0byB3b3JrIGluc2lkZSBub2RlanMgcHJvY2VzcywgYXMgdGhlIFdTTCB1c2VzIGFuIGVudmlyb25tZW50IHZhcmlhYmxlIHRvIGNvbm5lY3QgdG8gdGhlIFdpbmRvd3MgRG9ja2VyIGVuZ2luZSBzb2NrZXQuXG4gICAgZW52OiBPYmplY3QuYXNzaWduKHt9LCBwcm9jZXNzLmVudiwge1xuICAgICAgLy8gREVQTE9ZTUVOVDogJ2RldmVsb3BtZW50JyxcbiAgICB9KSxcbiAgfVxuICBjb25zdCBbY29tbWFuZCwgLi4uY29tbWFuZEFyZ3VtZW50XSA9IGV4ZWN1dGFibGVDb21tYW5kXG4gIHNwYXduU3luYyhjb21tYW5kLCBjb21tYW5kQXJndW1lbnQsIG9wdGlvbilcbn1cblxuLy8gY29tcG9zZSBvcHRpb25zIGh0dHBzOi8vZG9jcy5kb2NrZXIuY29tL2NvbXBvc2UvY29tcG9zZS1maWxlLyNlbnRyeXBvaW50XG4vLyBjb21wb3NlIGNvbW1hbmQgb3B0aW9ucyBodHRwczovL2RvY3MuZG9ja2VyLmNvbS9jb21wb3NlL3JlZmVyZW5jZS9vdmVydmlldy9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkb2NrZXJDb21wb3NlQ2xpKHsgYXBpIC8qIHN1cHBsaWVkIGJ5IHNjcmlwdE1hbmFnZXIgKi8sIHNjcmlwdENvbW1hbmQgPSAnL2Jpbi9iYXNoJyB9ID0ge30pIHtcbiAgY29uc3QgdGFyZ2V0UHJvamVjdENvbmYgPSBhcGkucHJvamVjdC5jb25maWd1cmF0aW9uLmNvbmZpZ3VyYXRpb24sXG4gICAgcm9vdFBhdGggPSBhcGkucHJvamVjdC5jb25maWd1cmF0aW9uLnJvb3RQYXRoLFxuICAgIHRhcmdldFRlbXBvcmFyeUZvbGRlciA9IHBhdGguam9pbihyb290UGF0aCwgJ3RlbXBvcmFyeScpLFxuICAgIGNvbnRhaW5lclByb2plY3RQYXRoID0gcm9vdFBhdGhcblxuICBhd2FpdCByZWN1cnNpdmVDcmVhdGVEaXJlY3RvcnkoeyBkaXJlY3RvcnlQYXRoOiB0YXJnZXRUZW1wb3JhcnlGb2xkZXIgfSlcblxuICBsZXQgb3B0aW9uID0ge1xuICAgIGN3ZDogcm9vdFBhdGgsXG4gICAgZGV0YWNoZWQ6IGZhbHNlLFxuICAgIHNoZWxsOiB0cnVlLFxuICAgIHN0ZGlvOiBbMCwgMSwgMl0sXG4gICAgLy8gSU1QT1JUQU5UOiBnbG9iYWwgZW52aXJvbm1lbnQgc2hvdWxkIGJlIHBhc3NlZCB0byBhbGxvdyBmb3IgZG9ja2VyIGNvbW1hbmRzIHRvIHdvcmsgaW5zaWRlIG5vZGVqcyBwcm9jZXNzLCBhcyB0aGUgV1NMIHVzZXMgYW4gZW52aXJvbm1lbnQgdmFyaWFibGUgdG8gY29ubmVjdCB0byB0aGUgV2luZG93cyBEb2NrZXIgZW5naW5lIHNvY2tldC5cbiAgICBlbnY6IE9iamVjdC5hc3NpZ24oe30sIHByb2Nlc3MuZW52LCB7XG4gICAgICAvLyBERVBMT1lNRU5UOiAnZGV2ZWxvcG1lbnQnLFxuICAgIH0pLFxuICB9XG5cbiAgbGV0IHBvcnRMaXN0ID0gW1xuICAgIC4uLnRhcmdldFByb2plY3RDb25mLmFwaUdhdGV3YXkuc2VydmljZS5tYXAoaXRlbSA9PiBpdGVtLnBvcnQpLmZpbHRlcihpdGVtID0+IGl0ZW0pLFxuICAgIC8vIEFkZGl0aW9uYWwgZGV2ZWxvcG1lbnQgcG9ydHNcbiAgICAuLi5bXG4gICAgICAvLyBOb2RlanMncyByZW1vdGUgZGVidWdnZXJcbiAgICAgIDkyMjksXG4gICAgICAvLyBCcm93c2Vyc3luYyBsaXZlcmVsb2FkXG4gICAgICA5MDkwLFxuICAgICAgOTkwMSxcbiAgICAgIDk5MDIsXG4gICAgXSxcbiAgXVxuICBsZXQgc2VydmljZUNvbmZpZyA9IHtcbiAgICB2ZXJzaW9uOiAnMy43JyxcblxuICAgIG5ldHdvcmtzOiB7XG4gICAgICBpbnRlcm5hbDoge1xuICAgICAgICBkcml2ZXI6ICdicmlkZ2UnLCAvLyBuZXR3b3JrIGRpcnZlcjogIGJyaWRnZSBmb3IgdGhlIHNhbWUgaG9zdCwgd2hpbGUgb3ZlcmxheSBpcyBmb3Igc3dhcm0gaG9zdHMuXG4gICAgICB9LFxuICAgIH0sXG5cbiAgICBzZXJ2aWNlczoge1xuICAgICAgYXBwbGljYXRpb246IHtcbiAgICAgICAgaW1hZ2U6ICdub2RlOmN1cnJlbnQnLFxuXG4gICAgICAgIC8vIGV4cG9ydCBwb3J0cyB0byBob3N0IG1hY2hpbmU6XG4gICAgICAgIC8vIHRvIGNoYW5nZSBwb3J0IGludGVyZmFjZSAoaXApIHVzZSBcIjEyNy4wLjAuMTo4MDo4MFwiXG4gICAgICAgIHBvcnRzOiBwb3J0TGlzdC5tYXAocG9ydCA9PiB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHRhcmdldDogcG9ydCxcbiAgICAgICAgICAgIHB1Ymxpc2hlZDogcG9ydCxcbiAgICAgICAgICAgIC8vIG1vZGU6ICdob3N0JyxcbiAgICAgICAgICB9XG4gICAgICAgIH0pLFxuXG4gICAgICAgIHZvbHVtZXM6IFtcbiAgICAgICAgICBgJHtyb290UGF0aH06JHtjb250YWluZXJQcm9qZWN0UGF0aH1gLFxuICAgICAgICAgIC8vIGxvY2FsIGRldmVsb3BtZW50IHJlbGF0ZWQgcGF0aHNcbiAgICAgICAgICBgJHtkZXZlbG9wbWVudENvZGVGb2xkZXJ9OiR7ZGV2ZWxvcG1lbnRDb2RlRm9sZGVyfWAsXG4gICAgICAgICAgYCR7eWFybkxpbmtGb2xyZGVyfToke3lhcm5MaW5rRm9scmRlcn1gLFxuICAgICAgICAgIGAvdmFyL3J1bi9kb2NrZXIuc29jazovdmFyL3J1bi9kb2NrZXIuc29ja2AsXG4gICAgICAgIF0sXG5cbiAgICAgICAgbmV0d29ya3M6IHtcbiAgICAgICAgICBpbnRlcm5hbDoge1xuICAgICAgICAgICAgYWxpYXNlczogWydhcHBsaWNhdGlvbiddLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG5cbiAgICAgICAgd29ya2luZ19kaXI6IHJvb3RQYXRoLFxuICAgICAgICAvLyBJTVBPUlRBTlQ6IGlmIGV4ZWN1dGVkIHdpdGggY29tbWFuZCBgL2Jpbi9zaCAtYyAnJ2AsIGFzIGRlZmF1bHQgZG9ja2VyIGRvZXMsIHRoZSBpbnRlcnJ1cHQgc2lnbmFscyB3aWxsIG5vdCBiZSBwYXNzZWQgdG8gdGhlIHJ1bm5pbmcgcHJvY2VzcyBhbmQgdGh1cyB3aWxsIG5vdCBhYm9ydCB0aGUgY29udGFpbmVycy4gVGhlcmVmb3JlIC9iaW4vYmFzaCAtYyBzaG91bGQgYmUgdXNlZCwgb3IgRU5UUllQT0lOVCBpbnN0ZWFkIG9mIENPTU1BTkQgd2lsbCB1c2UgYmFzaCBieSBkZWZhdWx0LlxuICAgICAgICAvLyBJTVBPUlRBTlQ6IG5vZGUgLS1ldmFsIGRvZXNuJ3QgcGFzcyBzaWduYWxzIGNvcnJlY3RseSBpbiBkb2NrZXIgY29tbWFuZCwgYnV0IHdyYXBwaW5nIGl0IHRocm91Z2ggbnBtIHNjcmlwdHMgKHlhcm4gcnVuIDxzY3JpcHQgbmFtZT4pIGFkZHMgZnVuY3Rpb25hbGl0eS5cbiAgICAgICAgY29tbWFuZDogc2NyaXB0Q29tbWFuZCxcbiAgICAgICAgLy8gZW50cnlwb2ludDpcbiAgICAgICAgLy8gICAvLyBbJ25vZGUnLCBgLS1ldmFsYCwgYHJlcXVpcmUocHJvY2Vzcy5jd2QoKSkuYXBwbGljYXRpb24oe30se21lbWdyYXBoOntob3N0OidtZW1ncmFwaCd9fSlgXSB8fCBbJ3lhcm4nLCAncnVuJywgJ3J1bi1jb25maWd1cmVkRm9yQ29udGFpbmVyJ10gfHxcbiAgICAgICAgLy8gICBgJHtzY3JpcHRDb21tYW5kfWAuc3BsaXQoJyAnKS5maWx0ZXIoaXRlbSA9PiBpdGVtLmxlbmd0aCAvKlJlbW92ZSBlbXB0eSB2YWx1ZXMqLyksIC8vIGAvYmluL2Jhc2ggLWMgXCJscyAtYWxcImBcblxuICAgICAgICAvLyBodHRwczovL2RvY3MuZG9ja2VyLmNvbS9jb21wb3NlL2NvbXBvc2UtZmlsZS8jZG9tYWlubmFtZS1ob3N0bmFtZS1pcGMtbWFjX2FkZHJlc3MtcHJpdmlsZWdlZC1yZWFkX29ubHktc2htX3NpemUtc3RkaW5fb3Blbi10dHktdXNlci13b3JraW5nX2RpclxuICAgICAgICAvLyB3b3JrcyBvbmx5IHdpdGggZG9ja2VyLWNvbXBvc2UgcnVuIGJ1dCBkb2Vzbid0IHdvcmsgZm9yIHNvbWUgcmVhc29uIHdpdGggZG9ja2VyLWNvbXBvc2UgdXAgKHN0dWNrIG9uICdhdHRhY2hpbmcgPHNlcnZpY2VOYW1lPi4uJylcbiAgICAgICAgdHR5OiB0cnVlLFxuICAgICAgICBzdGRpbl9vcGVuOiB0cnVlLFxuICAgICAgfSxcblxuICAgICAgbWVtZ3JhcGg6IHtcbiAgICAgICAgaW1hZ2U6ICdtZW1ncmFwaDpsYXRlc3QnLFxuXG4gICAgICAgIC8vIGV4cG9ydCBwb3J0cyB0byBob3N0IG1hY2hpbmU6XG4gICAgICAgIHBvcnRzOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgdGFyZ2V0OiA3Njg3LFxuICAgICAgICAgICAgLy8gcHVibGlzaGVkOiA3Njg3LFxuICAgICAgICAgIH0sXG4gICAgICAgIF0sXG5cbiAgICAgICAgbmV0d29ya3M6IHtcbiAgICAgICAgICBpbnRlcm5hbDoge1xuICAgICAgICAgICAgYWxpYXNlczogWydtZW1ncmFwaCddLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0sXG4gIH1cblxuICAvLyBjb252ZXJ0IHNlcnZpY2UgY29uZmlndXJhdGlvbiBpbnRvIHlhbWwgZmlsZSBpbiB0ZW1wb3JhcnkgbG9jYXRpb24sIHRvIGJlIHVzZWQgbGF0ZXIgd2l0aCBkb2NrZXItY29tcG9zZS5cbiAgbGV0IHlhbWxGaWxlID0gcGF0aC5qb2luKHRhcmdldFRlbXBvcmFyeUZvbGRlciwgJ2RvY2tlckNvbXBvc2UueWFtbCcpXG4gIGZpbGVzeXN0ZW0ud3JpdGVGaWxlU3luYyh5YW1sRmlsZSwganNZYW1sLmR1bXAoc2VydmljZUNvbmZpZywgeyBsaW5lV2lkdGg6IEluZmluaXR5LCBub0NvbXBhdE1vZGU6IHRydWUgfSkpXG5cbiAgbGV0IGRvY2tlckNvbXBvc2VDb21tYW5kID0gYGRvY2tlci1jb21wb3NlIC0tZmlsZSAke3lhbWxGaWxlfSAtLXByb2plY3QtbmFtZSB3ZWJhcHBQcm9qZWN0IC0tbG9nLWxldmVsIElORk9gXG5cbiAge1xuICAgIC8vIE5vdGU6IG5lY2Vzc2FyeSBzdGVwIGFzIHJlY3JlYXRpbmcgc2VydmljZXMgd2lsbCB1c2UgcHJldmlvdXNseSBjcmVhdGVkIHZvbHVtZXMgKGUuZy4gZGF0YWJhc2UgYW5vbnltb3VzIHZvbHVtZSlcbiAgICAvLyBzdG9wIGFuZCByZW1vdmUgY29udGFpbmVycyBhbmQgdm9sdW1lcyByZWxhdGVkIHRvIHByb2plY3QgbmFtZSBmcm9tIHByZXZpb3VzIHJ1bm5pbmdcbiAgICBsZXQgZXhlY3V0YWJsZUNvbW1hbmQgPSBbXG4gICAgICBbXG4gICAgICAgIGRvY2tlckNvbXBvc2VDb21tYW5kLFxuICAgICAgICAnZG93biAtLXZvbHVtZXMnLCAvLyByZW1vdmUgdm9sdW1lcyBhdHRhY2hlZCB0byBjb250YWluZXJzLlxuICAgICAgXS5qb2luKCcgJyksXG4gICAgXVxuICAgIGNvbnN0IFtjb21tYW5kLCAuLi5jb21tYW5kQXJndW1lbnRdID0gZXhlY3V0YWJsZUNvbW1hbmRcbiAgICBzcGF3blN5bmMoY29tbWFuZCwgY29tbWFuZEFyZ3VtZW50LCBvcHRpb24pXG4gIH1cblxuICBsZXQgZXhlY3V0YWJsZUNvbW1hbmQgPSBbXG4gICAgW1xuICAgICAgZG9ja2VyQ29tcG9zZUNvbW1hbmQsXG5cbiAgICAgIC8vIHJ1bjogYWxsb3dzIGF0dGFjaGluZyB0byB0aGUgY29udGFpbmVyXG4gICAgICAvLyBzZXJ2aWNlLXBvcnRzIGFsbG93cyBtYXBwaW5nIG9mIHBvcnRzIHRvIGhvc3QgYXMgc2V0IGluIHltbCBmaWxlLlxuICAgICAgLy8gYHJ1biAtLXJtIC0tc2VydmljZS1wb3J0cyAtLXVzZS1hbGlhc2VzIGFwcGxpY2F0aW9uYCxcblxuICAgICAgLy8gdXBcbiAgICAgIC8vIC0tZGV0YWNoXG4gICAgICBgdXAgLS1uby1idWlsZCAtLWZvcmNlLXJlY3JlYXRlIC0tYWJvcnQtb24tY29udGFpbmVyLWV4aXQgLS1hbHdheXMtcmVjcmVhdGUtZGVwc2AsXG4gICAgXS5qb2luKCcgJyksXG4gIF1cblxuICBjb25zb2xlLmxvZygnY29udGFpbmVyIGNvbW1hbmQnICsgJzogXFxuJywgc2NyaXB0Q29tbWFuZClcbiAgY29uc29sZS5sb2coYOKAoiBkb2NrZXIgY29tbWFuZDogXCIke2V4ZWN1dGFibGVDb21tYW5kLmpvaW4oJyAnKX1cImApXG4gIGNvbnN0IFtjb21tYW5kLCAuLi5jb21tYW5kQXJndW1lbnRdID0gZXhlY3V0YWJsZUNvbW1hbmRcbiAgc3Bhd25TeW5jKGNvbW1hbmQsIGNvbW1hbmRBcmd1bWVudCwgb3B0aW9uKVxuXG4gIC8vIGRvd246IGFsbG93cyB0byByZW1vdmUgY29udGFpbmVycyBpbiBhZGRpdGlvbiB0byBzdG9wcGluZyB0aGVtLlxuICAvLyBUT0RPOiBEb2Vzbid0IHdvcmssIHNlZW1zIHJlbGF0ZWQgdG8gdGhlIHNpZ25hbCB0cmFuc21pdGlvbiB0byB0aGUgcHJvY2VzcyB0aHJvdWdoIGNvbnRhaW5lciBjb21tYW5kcy5cbiAgcHJvY2Vzcy5vbignU0lHSU5UJywgKGNvZGUsIHNpZ25hbCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKGBbUHJvY2VzcyAke3Byb2Nlc3MucGlkfV06IHNpZ25hbCAke3NpZ25hbH0sIGNvZGUgJHtjb2RlfTtgKVxuICAgIC8vIHN0b3AgYW5kIHJlbW92ZSBjb250YWluZXJzIHJlbGF0ZWQgdG8gcHJvamVjdCBuYW1lLlxuICAgIGxldCBleGVjdXRhYmxlQ29tbWFuZCA9IFtcbiAgICAgIFtcbiAgICAgICAgZG9ja2VyQ29tcG9zZUNvbW1hbmQsXG4gICAgICAgICdkb3duJyxcbiAgICAgICAgLy8gLS12b2x1bWVzIC8vcmVtb3ZlIHZvbHVtZXMgYXR0YWNoZWQgdG8gY29udGFpbmVycy5cbiAgICAgIF0uam9pbignICcpLFxuICAgIF1cbiAgICBjb25zdCBbY29tbWFuZCwgLi4uY29tbWFuZEFyZ3VtZW50XSA9IGV4ZWN1dGFibGVDb21tYW5kXG4gICAgc3Bhd25TeW5jKGNvbW1hbmQsIGNvbW1hbmRBcmd1bWVudCwgb3B0aW9uKVxuICB9KVxufVxuIl19